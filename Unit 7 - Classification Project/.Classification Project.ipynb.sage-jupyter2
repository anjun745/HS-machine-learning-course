{"backend_state":"init","connection_file":"/tmp/xdg-runtime-user/jupyter/kernel-dcb65223-eb4a-483f-87fc-865f9aaa8266.json","kernel":"python3","kernel_error":"","kernel_state":"idle","kernel_usage":{"cpu":0,"memory":0},"metadata":{"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.8.5"}},"trust":true,"type":"settings"}
{"cell_type":"code","exec_count":102,"id":"9613fc","input":"#insert 11\n# using random Forest\nnew = df.sample(n=1)\nname = new[['name']]\nnew = new[['size', 'retention', 'branches', 'online_only', 'under_investigation',\n       'most_common_degree', 'highest_degree', 'faculty_salary',\n       'instructional_expenditure_per_fte', 'tuition_revenue_per_fte',\n       'part_time_share', 'age_entry', 'percent_dependent', 'first_generation',\n       'percent_black', 'avg_family_income', 'ind_low_income',\n       'dep_low_income', 'loan_principal', 'federal_loan_rate',\n       'students_with_any_loans', 'pell_grant_debt', 'percent_pell_grant',\n       'fafsa_sent', '7_yr_repayment_completion', '5_year_declining_balance',\n       'relig_y_n', 'accred_y_n', 'retention_listed_y_n',\n       'fac_salary_listed_y_n', '7_yr_repayment_completion_y_n',\n       '5_year_declining_balance_y_n']]\nd = new.values.tolist()\na = model4.predict(d)\nprint(name)\nprint('the prediction for the college is: ', a)","output":{"0":{"name":"stdout","output_type":"stream","text":"                                               name\n3597  Minnesota State College-SE Technical-Red Wing\nthe prediction for the college is:  [0]\n"}},"pos":35,"scrolled":true,"type":"cell"}
{"cell_type":"code","exec_count":124,"id":"c71136","input":"# insert 12\ndf_worst = df[df.for_profit == 1]  # only looking at the ones which are for profit\n\n# worst school based on federal loan\nfed = df.loc[[df_worst['federal_loan_rate'].argmax()]]['name'][df_worst['federal_loan_rate'].argmax()]\nprint('worst in terms of federal loan: ', fed)\n\n# worst school based on lowest dependent income\ndep = df.loc[[df_worst['dep_low_income'].argmin()]]['name'][df_worst['dep_low_income'].argmin()]\nprint('worst in terms of lowest dependent income: ', dep)\n\n# worst school based on price to space\nft = df.loc[[df_worst['tuition_revenue_per_fte'].argmin()]]['name'][df_worst['tuition_revenue_per_fte'].argmin()]\nprint('worst in terms of: ', ft)","output":{"0":{"name":"stdout","output_type":"stream","text":"worst in terms of federal loan:  University Academy of Hair Design\nworst in terms of lowest dependent income:  Professional Hands Institute\nworst in terms of:  Chaffey College\n"}},"pos":37,"type":"cell"}
{"cell_type":"code","exec_count":19,"id":"42e7c2","input":"df = pd.read_csv('data/schools.csv', index_col = 0)\nprint(df.shape)\ndf.head()","output":{"0":{"name":"stdout","output_type":"stream","text":"(6740, 46)\n"},"1":{"data":{"text/html":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>name</th>\n      <th>ownership</th>\n      <th>ope6_id</th>\n      <th>state</th>\n      <th>size</th>\n      <th>accreditor</th>\n      <th>retention</th>\n      <th>branches</th>\n      <th>online_only</th>\n      <th>religious_affil</th>\n      <th>...</th>\n      <th>fafsa_sent</th>\n      <th>7_yr_repayment_completion</th>\n      <th>5_year_declining_balance</th>\n      <th>relig_y_n</th>\n      <th>accred_y_n</th>\n      <th>retention_listed_y_n</th>\n      <th>fac_salary_listed_y_n</th>\n      <th>7_yr_repayment_completion_y_n</th>\n      <th>5_year_declining_balance_y_n</th>\n      <th>for_profit</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>Alaska Bible College</td>\n      <td>2</td>\n      <td>8843</td>\n      <td>AK</td>\n      <td>27</td>\n      <td>Association for Bibical Higher Educaiton</td>\n      <td>0.333300</td>\n      <td>1</td>\n      <td>0</td>\n      <td>88.0</td>\n      <td>...</td>\n      <td>0.463652</td>\n      <td>0.699542</td>\n      <td>0.496850</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>Alaska Christian College</td>\n      <td>2</td>\n      <td>41386</td>\n      <td>AK</td>\n      <td>68</td>\n      <td>Association for Bibical Higher Educaiton</td>\n      <td>0.473700</td>\n      <td>1</td>\n      <td>0</td>\n      <td>37.0</td>\n      <td>...</td>\n      <td>0.463652</td>\n      <td>0.699542</td>\n      <td>0.496850</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>Ilisagvik College</td>\n      <td>1</td>\n      <td>34613</td>\n      <td>AK</td>\n      <td>109</td>\n      <td>Northwest Commission on Colleges and Universities</td>\n      <td>0.809500</td>\n      <td>1</td>\n      <td>0</td>\n      <td>-2.0</td>\n      <td>...</td>\n      <td>0.463652</td>\n      <td>0.699542</td>\n      <td>0.496850</td>\n      <td>0</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>Charter College-Anchorage</td>\n      <td>3</td>\n      <td>25769</td>\n      <td>AK</td>\n      <td>3256</td>\n      <td>Accrediting Council for Independent Colleges a...</td>\n      <td>0.703723</td>\n      <td>1</td>\n      <td>0</td>\n      <td>-2.0</td>\n      <td>...</td>\n      <td>0.310288</td>\n      <td>0.725806</td>\n      <td>0.417949</td>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>Alaska Career College</td>\n      <td>3</td>\n      <td>25410</td>\n      <td>AK</td>\n      <td>479</td>\n      <td>Accrediting Commission of Career Schools and C...</td>\n      <td>0.794100</td>\n      <td>1</td>\n      <td>0</td>\n      <td>-2.0</td>\n      <td>...</td>\n      <td>0.254237</td>\n      <td>0.556430</td>\n      <td>0.462520</td>\n      <td>0</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n    </tr>\n  </tbody>\n</table>\n<p>5 rows Ã— 46 columns</p>\n</div>","text/plain":"                        name  ownership  ope6_id state  size  \\\n0       Alaska Bible College          2     8843    AK    27   \n1   Alaska Christian College          2    41386    AK    68   \n2          Ilisagvik College          1    34613    AK   109   \n3  Charter College-Anchorage          3    25769    AK  3256   \n4      Alaska Career College          3    25410    AK   479   \n\n                                          accreditor  retention  branches  \\\n0           Association for Bibical Higher Educaiton   0.333300         1   \n1           Association for Bibical Higher Educaiton   0.473700         1   \n2  Northwest Commission on Colleges and Universities   0.809500         1   \n3  Accrediting Council for Independent Colleges a...   0.703723         1   \n4  Accrediting Commission of Career Schools and C...   0.794100         1   \n\n   online_only  religious_affil  ...  fafsa_sent  7_yr_repayment_completion  \\\n0            0             88.0  ...    0.463652                   0.699542   \n1            0             37.0  ...    0.463652                   0.699542   \n2            0             -2.0  ...    0.463652                   0.699542   \n3            0             -2.0  ...    0.310288                   0.725806   \n4            0             -2.0  ...    0.254237                   0.556430   \n\n   5_year_declining_balance  relig_y_n  accred_y_n  retention_listed_y_n  \\\n0                  0.496850          1           1                     1   \n1                  0.496850          1           1                     1   \n2                  0.496850          0           1                     1   \n3                  0.417949          0           1                     0   \n4                  0.462520          0           1                     1   \n\n   fac_salary_listed_y_n  7_yr_repayment_completion_y_n  \\\n0                      1                              0   \n1                      1                              0   \n2                      1                              0   \n3                      1                              1   \n4                      1                              1   \n\n   5_year_declining_balance_y_n  for_profit  \n0                             0           0  \n1                             0           0  \n2                             0           0  \n3                             1           1  \n4                             1           1  \n\n[5 rows x 46 columns]"},"exec_count":19,"output_type":"execute_result"}},"pos":2,"type":"cell"}
{"cell_type":"code","exec_count":20,"id":"4a2413","input":"X = df[['size','retention','branches', 'online_only', 'under_investigation', 'most_common_degree', 'highest_degree',\n       'faculty_salary', 'instructional_expenditure_per_fte',\n       'tuition_revenue_per_fte', 'part_time_share',\n       'age_entry', 'percent_dependent', 'first_generation', 'percent_black',\n        'avg_family_income','ind_low_income', 'dep_low_income', 'loan_principal',\n       'federal_loan_rate', 'students_with_any_loans',\n       'pell_grant_debt', 'percent_pell_grant',\n       'fafsa_sent', '7_yr_repayment_completion', '5_year_declining_balance',\n       'relig_y_n', 'accred_y_n', 'retention_listed_y_n',\n       'fac_salary_listed_y_n', '7_yr_repayment_completion_y_n',\n       '5_year_declining_balance_y_n', 'for_profit']]\nX.head()","output":{"0":{"data":{"text/html":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>size</th>\n      <th>retention</th>\n      <th>branches</th>\n      <th>online_only</th>\n      <th>under_investigation</th>\n      <th>most_common_degree</th>\n      <th>highest_degree</th>\n      <th>faculty_salary</th>\n      <th>instructional_expenditure_per_fte</th>\n      <th>tuition_revenue_per_fte</th>\n      <th>...</th>\n      <th>fafsa_sent</th>\n      <th>7_yr_repayment_completion</th>\n      <th>5_year_declining_balance</th>\n      <th>relig_y_n</th>\n      <th>accred_y_n</th>\n      <th>retention_listed_y_n</th>\n      <th>fac_salary_listed_y_n</th>\n      <th>7_yr_repayment_completion_y_n</th>\n      <th>5_year_declining_balance_y_n</th>\n      <th>for_profit</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>27</td>\n      <td>0.333300</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>3</td>\n      <td>3</td>\n      <td>2201</td>\n      <td>9585</td>\n      <td>8132</td>\n      <td>...</td>\n      <td>0.463652</td>\n      <td>0.699542</td>\n      <td>0.496850</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>68</td>\n      <td>0.473700</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n      <td>2</td>\n      <td>5554</td>\n      <td>18174</td>\n      <td>12989</td>\n      <td>...</td>\n      <td>0.463652</td>\n      <td>0.699542</td>\n      <td>0.496850</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>109</td>\n      <td>0.809500</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n      <td>2</td>\n      <td>6054</td>\n      <td>38265</td>\n      <td>3587</td>\n      <td>...</td>\n      <td>0.463652</td>\n      <td>0.699542</td>\n      <td>0.496850</td>\n      <td>0</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>3256</td>\n      <td>0.703723</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n      <td>3</td>\n      <td>4004</td>\n      <td>2617</td>\n      <td>8755</td>\n      <td>...</td>\n      <td>0.310288</td>\n      <td>0.725806</td>\n      <td>0.417949</td>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>479</td>\n      <td>0.794100</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n      <td>2</td>\n      <td>3861</td>\n      <td>4178</td>\n      <td>11905</td>\n      <td>...</td>\n      <td>0.254237</td>\n      <td>0.556430</td>\n      <td>0.462520</td>\n      <td>0</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1</td>\n    </tr>\n  </tbody>\n</table>\n<p>5 rows Ã— 33 columns</p>\n</div>","text/plain":"   size  retention  branches  online_only  under_investigation  \\\n0    27   0.333300         1            0                    0   \n1    68   0.473700         1            0                    0   \n2   109   0.809500         1            0                    0   \n3  3256   0.703723         1            0                    0   \n4   479   0.794100         1            0                    0   \n\n   most_common_degree  highest_degree  faculty_salary  \\\n0                   3               3            2201   \n1                   1               2            5554   \n2                   1               2            6054   \n3                   1               3            4004   \n4                   1               2            3861   \n\n   instructional_expenditure_per_fte  tuition_revenue_per_fte  ...  \\\n0                               9585                     8132  ...   \n1                              18174                    12989  ...   \n2                              38265                     3587  ...   \n3                               2617                     8755  ...   \n4                               4178                    11905  ...   \n\n   fafsa_sent  7_yr_repayment_completion  5_year_declining_balance  relig_y_n  \\\n0    0.463652                   0.699542                  0.496850          1   \n1    0.463652                   0.699542                  0.496850          1   \n2    0.463652                   0.699542                  0.496850          0   \n3    0.310288                   0.725806                  0.417949          0   \n4    0.254237                   0.556430                  0.462520          0   \n\n   accred_y_n  retention_listed_y_n  fac_salary_listed_y_n  \\\n0           1                     1                      1   \n1           1                     1                      1   \n2           1                     1                      1   \n3           1                     0                      1   \n4           1                     1                      1   \n\n   7_yr_repayment_completion_y_n  5_year_declining_balance_y_n  for_profit  \n0                              0                             0           0  \n1                              0                             0           0  \n2                              0                             0           0  \n3                              1                             1           1  \n4                              1                             1           1  \n\n[5 rows x 33 columns]"},"exec_count":20,"output_type":"execute_result"}},"pos":4,"type":"cell"}
{"cell_type":"code","exec_count":21,"id":"88c6fe","input":"y = X.pop('for_profit')\n\nX_new = SelectKBest(chi2, k=2).fit(X, y)\n\nfeatures = []\nfor i, column in enumerate(X.columns):\n    features.append((X_new.pvalues_[i], column))\nfeatures.sort()\nprint('chi2-value', 'feature')\nfeatures","output":{"0":{"name":"stdout","output_type":"stream","text":"chi2-value feature\n"},"1":{"data":{"text/plain":"[(0.0, 'avg_family_income'),\n (0.0, 'branches'),\n (0.0, 'faculty_salary'),\n (0.0, 'instructional_expenditure_per_fte'),\n (0.0, 'loan_principal'),\n (0.0, 'pell_grant_debt'),\n (0.0, 'size'),\n (0.0, 'tuition_revenue_per_fte'),\n (5.339096890496358e-283, 'highest_degree'),\n (2.3550018048916394e-222, 'most_common_degree'),\n (5.4025502611485345e-149, 'fac_salary_listed_y_n'),\n (8.240679129762035e-148, 'relig_y_n'),\n (5.293172158552389e-143, 'age_entry'),\n (1.4125160311610646e-48, 'percent_dependent'),\n (1.4293811306587033e-24, '5_year_declining_balance'),\n (1.3527931483014148e-21, 'federal_loan_rate'),\n (6.095800240149737e-17, 'percent_black'),\n (3.249757484509402e-15, 'fafsa_sent'),\n (2.3099399670297378e-10, '7_yr_repayment_completion'),\n (5.332261659651027e-09, 'first_generation'),\n (1.407934457452266e-08, 'part_time_share'),\n (1.516370320447562e-08, 'dep_low_income'),\n (5.3899600324359155e-08, 'percent_pell_grant'),\n (2.942362811776623e-06, 'students_with_any_loans'),\n (9.035892891499908e-06, 'under_investigation'),\n (0.006314439338573356, 'retention_listed_y_n'),\n (0.012536378966747178, 'online_only'),\n (0.01746153785302309, 'ind_low_income'),\n (0.5021649291685133, '5_year_declining_balance_y_n'),\n (0.6158853388832394, 'retention'),\n (0.8250416943743915, 'accred_y_n'),\n (0.9230148052834302, '7_yr_repayment_completion_y_n')]"},"exec_count":21,"output_type":"execute_result"}},"pos":6,"type":"cell"}
{"cell_type":"code","exec_count":22,"id":"420154","input":"#insert 2\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3)\nmodel0 = LogisticRegression(multi_class = \"auto\", solver = 'lbfgs', max_iter=1000)\nmodel0.fit(X_train, y_train)\nacc_test = model0.score(X_test, y_test)\nprint(f\"test_score = {acc_test}\")","output":{"0":{"name":"stdout","output_type":"stream","text":"test_score = 0.8991097922848664\n"}},"pos":10,"type":"cell"}
{"cell_type":"code","exec_count":23,"id":"686b0c","input":"#insert 3\nscores = []\nfor k in range(1, 21):\n    knn = KNeighborsClassifier(n_neighbors=k)\n    scores_ = cross_val_score(knn, X_train, y_train, cv=3, scoring='accuracy')\n    scores.append((k, scores_.mean()))\n\nscores = pd.DataFrame(scores, columns=['k', 'accuracy']).set_index('k')\nk_max = scores[scores.accuracy==max(scores.accuracy)]\nk_max","output":{"0":{"data":{"text/html":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>accuracy</th>\n    </tr>\n    <tr>\n      <th>k</th>\n      <th></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>7</th>\n      <td>0.895294</td>\n    </tr>\n  </tbody>\n</table>\n</div>","text/plain":"   accuracy\nk          \n7  0.895294"},"exec_count":23,"output_type":"execute_result"}},"pos":12,"scrolled":true,"type":"cell"}
{"cell_type":"code","exec_count":24,"id":"fe645f","input":"#insert 4\nprint(classification_report(y, model0.predict(X)))","output":{"0":{"name":"stdout","output_type":"stream","text":"              precision    recall  f1-score   support\n\n           0       0.93      0.90      0.91      3835\n           1       0.87      0.90      0.89      2905\n\n    accuracy                           0.90      6740\n   macro avg       0.90      0.90      0.90      6740\nweighted avg       0.90      0.90      0.90      6740\n\n"}},"pos":14,"type":"cell"}
{"cell_type":"code","exec_count":25,"id":"a7dcfe","input":"#insert 5\nconfusion_matrix(y, model0.predict(X))","output":{"0":{"data":{"text/plain":"array([[3439,  396],\n       [ 276, 2629]])"},"exec_count":25,"output_type":"execute_result"}},"pos":19,"type":"cell"}
{"cell_type":"code","exec_count":27,"id":"28e436","input":"y_KNN = model0.predict_proba(X_test)[:, 1]\n\nmodel1 = naive_bayes.GaussianNB()\nmodel1.fit(X_train, y_train)\ny_NB = model1.predict_proba(X_test)[:, 1]\n\nmodel2 = GradientBoostingClassifier()\nmodel2.fit(X_train, y_train)\ny_GB = model2.predict_proba(X_test)[:, 1]\n\nmodel3 = LogisticRegression()\nmodel3.fit(X_train, y_train)\ny_LR = model3.predict_proba(X_test)[:, 1]","output":{"0":{"name":"stderr","output_type":"stream","text":"/usr/local/lib/python3.8/dist-packages/sklearn/linear_model/_logistic.py:763: ConvergenceWarning: lbfgs failed to converge (status=1):\nSTOP: TOTAL NO. of ITERATIONS REACHED LIMIT.\n\nIncrease the number of iterations (max_iter) or scale the data as shown in:\n    https://scikit-learn.org/stable/modules/preprocessing.html\nPlease also refer to the documentation for alternative solver options:\n    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression\n  n_iter_i = _check_optimize_result(\n"}},"pos":23,"type":"cell"}
{"cell_type":"code","exec_count":29,"id":"a9c973","input":"#insert 7\nfeature1 = 'instructional_expenditure_per_fte'\nfeature2 = '5_year_declining_balance'\nX = X[[feature1, feature2]]  # setting up the features, this much I can unders\n\nmodel = LogisticRegression(multi_class = 'auto', solver = 'lbfgs', max_iter = 10000)  # creating a model\n\nX_scalar = StandardScaler()\nx2 = X_scalar.fit_transform(X)  # applying a standard scalar transformation\nx2 = pd.DataFrame(x2)\n\nQ = x2.values\nh = 0.01  # smaller mesh size would lead to more resources used\nx_min, x_max = Q[:, 0].min() - 0.5, Q[:, 0].max() + 0.5\ny_min, y_max = Q[:, 1].min() - 0.5, Q[:, 1].max() + 0.5\nxx, yy = np.meshgrid(np.arange(x_min, x_max, h), np.arange(y_min, y_max, h))  # h is like a step size, so it owuld make sense to be bigger if we want it faster\n\n# from here on down is mostly plotting, and I don't really understand\nmodel.fit(x2, y)\nz = model.predict(np.c_[xx.ravel(), yy.ravel()])\n\nz = z.reshape(xx.shape)\nplt.figure(1, figsize=(4, 3))\nplt.pcolormesh(xx, yy, z, cmap=plt.cm.Paired)\n\nplt.scatter(Q[:, 0], Q[:, 1], c=y, edgecolor='k', cmap=plt.cm.Paired)\nplt.title(\"Decision boundaries with 2 attributes\")\nplt.xlabel(feature1)\nplt.ylabel(feature2)\n\nplt.xlim(xx.min(), 5)\nplt.ylim(yy.min(), 3)\nplt.show()","output":{"0":{"name":"stderr","output_type":"stream","text":"<ipython-input-29-c5d4698c6b52>:24: MatplotlibDeprecationWarning: shading='flat' when X and Y have the same dimensions as C is deprecated since 3.3.  Either specify the corners of the quadrilaterals with X and Y, or pass shading='auto', 'nearest' or 'gouraud', or set rcParams['pcolor.shading'].  This will become an error two minor releases later.\n  plt.pcolormesh(xx, yy, z, cmap=plt.cm.Paired)\n"},"1":{"data":{"image/png":"820ac24379f4a800a8d3d31f050c67baebf0678c","text/plain":"<Figure size 288x216 with 1 Axes>"},"exec_count":29,"metadata":{"image/png":{"height":223,"width":276},"needs_background":"light"},"output_type":"execute_result"}},"pos":26,"type":"cell"}
{"cell_type":"code","exec_count":32,"id":"3bb939","input":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\n%matplotlib inline\nfrom matplotlib.colors import ListedColormap\nimport matplotlib.cm as cm\n\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.model_selection import cross_val_score\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.linear_model import LogisticRegressionCV\nfrom sklearn import naive_bayes\nfrom sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.model_selection import GridSearchCV\nfrom sklearn.model_selection import KFold\nfrom sklearn import svm\nfrom sklearn.svm import SVC\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.ensemble import GradientBoostingClassifier\n\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.neural_network import MLPClassifier\n\nfrom sklearn.pipeline import Pipeline\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.pipeline import make_pipeline\n\nfrom sklearn.metrics import accuracy_score, confusion_matrix, classification_report\nfrom sklearn.metrics import roc_curve, roc_auc_score, average_precision_score\nfrom sklearn.metrics import precision_recall_curve\nfrom sklearn.metrics import precision_score, recall_score\n\nfrom itertools import product\n\nfrom sklearn.feature_selection import SelectKBest\nfrom sklearn.feature_selection import chi2\n\nfrom scipy.stats import mode","pos":0,"type":"cell"}
{"cell_type":"code","exec_count":35,"id":"63a8a8","input":"#insert 8\nmodel4 = RandomForestClassifier()\nmodel4.fit(X_train, y_train)\ny_RF = model4.predict_proba(X_test)[:, 1]","pos":28,"type":"cell"}
{"cell_type":"code","exec_count":36,"id":"d5efed","input":"#insert 9\nmodel5 = SVC(probability=True)\nmodel5.fit(X_train, y_train)\ny_SV = model5.predict_proba(X_test)[:, 1]","pos":30,"type":"cell"}
{"cell_type":"code","exec_count":42,"id":"0c55c8","input":"#insert 6\n# this is your plotting function\ndef plot_roc(ytrue, yproba, model, title='ROC plot of naive bayes, logistic, gradient boosting, and KNN'):\n    auc = roc_auc_score(ytrue, yproba)\n    fpr, tpr, thr = roc_curve(ytrue, yproba)\n    plt.plot([0, 1], [0, 1], color='k', linestyle='--', linewidth=.4)\n    plt.plot(fpr, tpr, label='{} auc={:.2f}%'.format(model, auc*100))\n    plt.axis('equal')\n    plt.xlim([-0.02, 0.82])\n    plt.ylim([0.3, 1.02])\n    plt.ylabel('tpr')\n    plt.xlabel('fpr')\n    plt.title(title)\n    plt.legend(loc='best')\n    plt.grid(True)","pos":22,"type":"cell"}
{"cell_type":"code","exec_count":43,"id":"58e322","input":"plot_roc(y_test, y_NB, \"Naive Bayes\")\nplot_roc(y_test, y_GB, \"Gradient Boosting\")\nplot_roc(y_test, y_LR, \"Log Regression\")\nplot_roc(y_test, y_KNN, \"KNN\")","output":{"0":{"data":{"image/png":"10b6173c99dade1851d1824764e30f1ded7ee1f5","text/plain":"<Figure size 432x288 with 1 Axes>"},"exec_count":43,"metadata":{"image/png":{"height":277,"width":402},"needs_background":"light"},"output_type":"execute_result"}},"pos":24,"type":"cell"}
{"cell_type":"code","exec_count":47,"id":"acde45","input":"X_test.columns","output":{"0":{"data":{"text/plain":"Index(['size', 'retention', 'branches', 'online_only', 'under_investigation',\n       'most_common_degree', 'highest_degree', 'faculty_salary',\n       'instructional_expenditure_per_fte', 'tuition_revenue_per_fte',\n       'part_time_share', 'age_entry', 'percent_dependent', 'first_generation',\n       'percent_black', 'avg_family_income', 'ind_low_income',\n       'dep_low_income', 'loan_principal', 'federal_loan_rate',\n       'students_with_any_loans', 'pell_grant_debt', 'percent_pell_grant',\n       'fafsa_sent', '7_yr_repayment_completion', '5_year_declining_balance',\n       'relig_y_n', 'accred_y_n', 'retention_listed_y_n',\n       'fac_salary_listed_y_n', '7_yr_repayment_completion_y_n',\n       '5_year_declining_balance_y_n'],\n      dtype='object')"},"exec_count":47,"output_type":"execute_result"}},"pos":34,"type":"cell"}
{"cell_type":"code","exec_count":48,"id":"c3710f","input":"#insert 10\nplot_roc(y_test, y_NB, \"Naive Bayes\")\nplot_roc(y_test, y_GB, \"Gradient Boosting\")\nplot_roc(y_test, y_LR, \"Log Regression\")\nplot_roc(y_test, y_KNN, \"KNN\")\nplot_roc(y_test, y_RF, \"Random Forest\")\nplot_roc(y_test, y_SV, \"Support Vector\")","output":{"0":{"data":{"image/png":"030b2d5c8781e501eda070fa5137b5d543b82d6d","text/plain":"<Figure size 432x288 with 1 Axes>"},"exec_count":48,"metadata":{"image/png":{"height":277,"width":402},"needs_background":"light"},"output_type":"execute_result"}},"pos":32,"type":"cell"}
{"cell_type":"markdown","collapsed":true,"id":"a7c444","input":"7.Using the logarithmic regression model, plot a decision boundary between instructional_expenditure_per_fte and 5_year_declining_balance. Does it appear that for-profit status has a clear boundary based on these predictors?","pos":25,"type":"cell"}
{"cell_type":"markdown","id":"006b15","input":"3438 out of 3858 predicted non-profit universities are actually non-profit, and 397 out of those 3858 are for profit.\n2622 out of the 2905 predicted for profit universities were for profit, and 283 of those 2905 are non-profit.","pos":20,"type":"cell"}
{"cell_type":"markdown","id":"0d1830","input":"11.Take in a new school's data and predict the school's profit status using one of your previous classifier methods.","pos":33,"type":"cell"}
{"cell_type":"markdown","id":"2539c4","input":"14.Read several articles on college predatory practices and cite and incorporate them into your blog discussion. Remember to link to them clearly by using the \n```[here](http://....)``` syntax.","pos":40,"type":"cell"}
{"cell_type":"markdown","id":"26f7cf","input":"#insert 1\nThe P value I interpreted means that the lower it is, the more the feature is correlated to the y (for profit). I can't really say anything is suprising or intuitive as  I have minimal knowledge of economy, but I find the fact that 7 yrs repayment completion to have such a low correlation to be suprising as I figured that depending on profit the repayment (retirment fees?) should be more likely to be present","pos":8,"type":"cell"}
{"cell_type":"markdown","id":"28231b","input":"The precision for 0 is how many predicted non-profit universities are actually non-profit, and the precision for 1 is how many predicted for profit universities were actually for profit.","pos":15,"type":"cell"}
{"cell_type":"markdown","id":"425522","input":"1.How would you interpret P-values returned by the SelectKBest test above? What was intuitive? What was surprising? Does the P value determine how big (or small) of an effect accreditation has on for-profit status? What might be some guesses as to why this is the case?","pos":7,"type":"cell"}
{"cell_type":"markdown","id":"5ad0fc","input":"4.Run a classification report and describe in detail what the terms mean in the context of your model.","pos":13,"type":"cell"}
{"cell_type":"markdown","id":"5c0b4e","input":"6.Make a comparative ROC plot of the naive bayes, logistic, gradient boosting, and KNN classifiers.","pos":21,"type":"cell"}
{"cell_type":"markdown","id":"63ef82","input":"The F1 score is the balance between precision and recall for 0 and 1. The accuracy is the overall score of the the predictions, all the correct predictions over total predictions.","pos":17,"type":"cell"}
{"cell_type":"markdown","id":"66e24b","input":"We are going to use classification algorithms to try to predict for-profit or non-profit status. \n\nSome of the categories aren't applicable to what we want to do so let's consider the following columns only:\n","pos":3,"type":"cell"}
{"cell_type":"markdown","id":"6c6d0e","input":"13.If you were a governmental organization overseeing accreditation, what factors would be most important to you in making sure that the college was non-predatory? Give a lot of detail here as well in your blog.","pos":38,"type":"cell"}
{"cell_type":"markdown","id":"733895","input":"2.Do a test/train split and give the testing accuracy error for logistic regression.","pos":9,"type":"cell"}
{"cell_type":"markdown","id":"866282","input":"9.Support vector machines are another type of classifier. Read the docs [here](https://scikit-learn.org/stable/modules/generated/sklearn.svm.SVC.html) and then try implementing that one.","pos":29,"type":"cell"}
{"cell_type":"markdown","id":"948f09","input":"Let's first use a method called [SelectKBest](https://scikit-learn.org/stable/modules/generated/sklearn.feature_selection.chi2.html) to see which features have the most statistically significant relationships with profit status. The **lower** the p value, the **more** statistically significant:","pos":5,"type":"cell"}
{"cell_type":"markdown","id":"9aa6bf","input":"The recall for 0 is how many non-profit universities were predicted out of all the non-profit universities, and the recall for for 1 is how many for profit universities out of all for profit universities were predicted.","pos":16,"type":"cell"}
{"cell_type":"markdown","id":"a05eac","input":"I pulled and cleaned a comprehensive dataset of colleges from this governmental database:\n    \nhttps://collegescorecard.ed.gov/data/\n\nLet's read this dataset in:","pos":1,"type":"cell"}
{"cell_type":"markdown","id":"ac571e","input":"8.We have not covered random forests but they are a very popular type of classifier. It is very good practice in reading the docs to get a new classifier working. Read [this](https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.RandomForestClassifier.html) and then apply the RandomForestClassifier().","pos":27,"scrolled":true,"type":"cell"}
{"cell_type":"markdown","id":"b5db2d","input":"3.Find the optimal number of nearest neighbors for KNN using grid search and then give the test accuracy. ","pos":11,"type":"cell"}
{"cell_type":"markdown","id":"b8e157","input":"5.Print a confusion matrix and describe what it means in your context.","pos":18,"type":"cell"}
{"cell_type":"markdown","id":"b9170f","input":"12.What are the worst schools? Some of them are chains of schools so don't necessarily consider singular names but generalize to chains. Give a lot of justification for your analysis as everyone might have a different answer here. Insert these responses into your blog.","pos":36,"type":"cell"}
{"cell_type":"markdown","id":"c0056b","input":"10. Make a comparative ROC plot of the naive bayes, logistic, gradient boosting, KNN classifiers, random forest, and SVM classifiers.","pos":31,"type":"cell"}
{"cell_type":"markdown","id":"fec396","input":"#insert 13\nLikely federal loan rate and whether or not the schools are acreditted, because that is what the government needs to know, the taxes paid are spent wisely, aside from that, perhaps also income level and whether or not they are dependent. If the government is to be more strict, perhaps they should look into any loan too.","pos":39,"type":"cell"}
{"cell_type":"raw","exec_count":0,"id":"32ae23","input":"https://www.americanprogress.org/issues/democracy/news/2019/07/29/472805/predatory-profit-colleges-benefit-washingtons-culture-corruption/\napparently trump made more for profit schools?\nhttps://www.arnoldventures.org/stories/misery-factories-at-for-profit-colleges-a-web-of-predatory-behavior/\nThese schools might not even have accreditation, which makes them not worth going to in the first place, which will screw students over\nhttps://predatorystudentlending.org/information-for-for-profit-college-students/\nSchools that pressure for quick enrollments and encourages large loans are likely to bepredatory, unengaged instructors may also be a sign","pos":41,"type":"cell"}
{"id":0,"time":1619117356061,"type":"user"}
{"last_load":1619117353570,"type":"file"}